(function(){"use strict";var e={8944:function(e,s,t){var n=t(144),r=function(){var e=this,s=e._self._c;return s("div",{attrs:{id:"app"}},[e.usernameAlreadySelected?s("chat"):s("select-username",{on:{input:e.onUsernameSelection}})],1)},o=[],a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"select-username"},[s("form",{on:{submit:function(s){return s.preventDefault(),e.onSubmit.apply(null,arguments)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{placeholder:"Your username..."},domProps:{value:e.username},on:{input:function(s){s.target.composing||(e.username=s.target.value)}}}),s("button",{attrs:{disabled:!e.isValid}},[e._v("Send")])])])},u=[],i={name:"SelectUsername",data(){return{username:""}},computed:{isValid(){return this.username.length>2}},methods:{onSubmit(){this.$emit("input",this.username)}}},c=i,l=t(1001),d=(0,l.Z)(c,a,u,!1,null,"527ffbd1",null),f=d.exports,m=function(){var e=this,s=e._self._c;return s("div",[s("div",{staticClass:"left-panel"},e._l(e.users,(function(t){return s("user",{key:t.userID,attrs:{user:t,selected:e.selectedUser===t},on:{select:function(s){return e.onSelectUser(t)}}})})),1),e.selectedUser?s("message-panel",{staticClass:"right-panel",attrs:{user:e.selectedUser},on:{input:e.onMessage}}):e._e()],1)},p=[],h=(t(560),t(3920));const v="http://localhost:3000",g=(0,h.io)(v,{autoConnect:!1});g.onAny(((e,...s)=>{console.log(e,s)}));var _=g,b=function(){var e=this,s=e._self._c;return s("div",{staticClass:"user",class:{selected:e.selected},on:{click:e.onClick}},[s("div",{staticClass:"description"},[s("div",{staticClass:"name"},[e._v(" "+e._s(e.user.username)+" "+e._s(e.user.self?" (yourself)":"")+" ")]),s("div",{staticClass:"status"},[s("status-icon",{attrs:{connected:e.user.connected}}),e._v(e._s(e.status)+" ")],1)]),e.user.hasNewMessages?s("div",{staticClass:"new-messages"},[e._v("!")]):e._e()])},S=[],y=function(){var e=this,s=e._self._c;return s("i",{staticClass:"icon",class:{connected:e.connected}})},I=[],C={name:"StatusIcon",props:{connected:Boolean}},D=C,U=(0,l.Z)(D,y,I,!1,null,"63872e50",null),w=U.exports,O={name:"User",components:{StatusIcon:w},props:{user:Object,selected:Boolean},methods:{onClick(){this.$emit("select")}},computed:{status(){return this.user.connected?"online":"offline"}}},x=O,k=(0,l.Z)(x,b,S,!1,null,"4a7c93a0",null),j=k.exports,M=function(){var e=this,s=e._self._c;return s("div",[s("div",{staticClass:"header"},[s("status-icon",{attrs:{connected:e.user.connected}}),e._v(e._s(e.user.username)+" ")],1),s("ul",{staticClass:"messages"},e._l(e.user.messages,(function(t,n){return s("li",{key:n,staticClass:"message"},[e.displaySender(t,n)?s("div",{staticClass:"sender"},[e._v(" "+e._s(t.fromSelf?"(yourself)":e.user.username)+" ")]):e._e(),e._v(" "+e._s(t.content)+" ")])})),0),s("form",{staticClass:"form",on:{submit:function(s){return s.preventDefault(),e.onSubmit.apply(null,arguments)}}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.input,expression:"input"}],staticClass:"input",attrs:{placeholder:"Your message..."},domProps:{value:e.input},on:{input:function(s){s.target.composing||(e.input=s.target.value)}}}),e._v(" "),s("button",{staticClass:"send-button",attrs:{disabled:!e.isValid}},[e._v("Send")])])])},P=[],Z={name:"MessagePanel",components:{StatusIcon:w},props:{user:Object},data(){return{input:""}},methods:{onSubmit(){this.$emit("input",this.input),this.input=""},displaySender(e,s){return 0===s||this.user.messages[s-1].fromSelf!==this.user.messages[s].fromSelf}},computed:{isValid(){return this.input.length>0}}},A=Z,N=(0,l.Z)(A,M,P,!1,null,"9fcb6af4",null),E=N.exports,T={name:"Chat",components:{User:j,MessagePanel:E},data(){return{selectedUser:null,users:[]}},methods:{onMessage(e){this.selectedUser&&(_.emit("private message",{content:e,to:this.selectedUser.userID}),this.selectedUser.messages.push({content:e,fromSelf:!0}))},onSelectUser(e){this.selectedUser=e,e.hasNewMessages=!1}},created(){_.on("connect",(()=>{this.users.forEach((e=>{e.self&&(e.connected=!0)}))})),_.on("disconnect",(()=>{this.users.forEach((e=>{e.self&&(e.connected=!1)}))}));const e=e=>{e.hasNewMessages=!1};_.on("users",(s=>{s.forEach((s=>{s.messages.forEach((e=>{e.fromSelf=e.from===_.userID}));for(let e=0;e<this.users.length;e++){const t=this.users[e];if(t.userID===s.userID)return t.connected=s.connected,void(t.messages=s.messages)}s.self=s.userID===_.userID,e(s),this.users.push(s)})),this.users.sort(((e,s)=>e.self?-1:s.self?1:e.username<s.username?-1:e.username>s.username?1:0))})),_.on("user connected",(s=>{for(let e=0;e<this.users.length;e++){const t=this.users[e];if(t.userID===s.userID)return void(t.connected=!0)}e(s),this.users.push(s)})),_.on("user disconnected",(e=>{for(let s=0;s<this.users.length;s++){const t=this.users[s];if(t.userID===e){t.connected=!1;break}}})),_.on("private message",(({content:e,from:s,to:t})=>{for(let n=0;n<this.users.length;n++){const r=this.users[n],o=_.userID===s;if(r.userID===(o?t:s)){r.messages.push({content:e,fromSelf:o}),r!==this.selectedUser&&(r.hasNewMessages=!0);break}}}))},destroyed(){_.off("connect"),_.off("disconnect"),_.off("users"),_.off("user connected"),_.off("user disconnected"),_.off("private message")}},V=T,$=(0,l.Z)(V,m,p,!1,null,"9976383c",null),B=$.exports,Y={name:"App",components:{Chat:B,SelectUsername:f},data(){return{usernameAlreadySelected:!1}},methods:{onUsernameSelection(e){this.usernameAlreadySelected=!0,_.auth={username:e},_.connect()}},created(){const e=localStorage.getItem("sessionID");e&&(this.usernameAlreadySelected=!0,_.auth={sessionID:e},_.connect()),_.on("session",(({sessionID:e,userID:s})=>{_.auth={sessionID:e},localStorage.setItem("sessionID",e),_.userID=s})),_.on("connect_error",(e=>{"invalid username"===e.message&&(this.usernameAlreadySelected=!1)}))},destroyed(){_.off("connect_error")}},F=Y,q=(0,l.Z)(F,r,o,!1,null,null,null),z=q.exports;n.ZP.config.productionTip=!1,new n.ZP({render:e=>e(z)}).$mount("#app")}},s={};function t(n){var r=s[n];if(void 0!==r)return r.exports;var o=s[n]={exports:{}};return e[n].call(o.exports,o,o.exports,t),o.exports}t.m=e,function(){var e=[];t.O=function(s,n,r,o){if(!n){var a=1/0;for(l=0;l<e.length;l++){n=e[l][0],r=e[l][1],o=e[l][2];for(var u=!0,i=0;i<n.length;i++)(!1&o||a>=o)&&Object.keys(t.O).every((function(e){return t.O[e](n[i])}))?n.splice(i--,1):(u=!1,o<a&&(a=o));if(u){e.splice(l--,1);var c=r();void 0!==c&&(s=c)}}return s}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[n,r,o]}}(),function(){t.d=function(e,s){for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,n){var r,o,a=n[0],u=n[1],i=n[2],c=0;if(a.some((function(s){return 0!==e[s]}))){for(r in u)t.o(u,r)&&(t.m[r]=u[r]);if(i)var l=i(t)}for(s&&s(n);c<a.length;c++)o=a[c],t.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return t.O(l)},n=self["webpackChunkprivate_messaging"]=self["webpackChunkprivate_messaging"]||[];n.forEach(s.bind(null,0)),n.push=s.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(8944)}));n=t.O(n)})();
//# sourceMappingURL=app.b695843a.js.map